import React from 'react';
import ChatBot from 'react-simple-chatbot';
import { ThemeProvider } from 'styled-components';
import '../../styles/AIChat.css';

// Chatbot theme configuration
const theme = {
  background: '#fff',
  fontFamily: 'Cairo, sans-serif',
  headerBgColor: '#0d6efd',
  headerFontColor: '#fff',
  headerFontSize: '1rem',
  botBubbleColor: '#f1f3f5',
  botFontColor: '#333',
  userBubbleColor: '#0d6efd',
  userFontColor: '#fff',
};

const steps = [
  // --- Welcome & Main Menu ---
  {
    id: 'welcome',
    message: 'ุฃููุงู ุจู ูู ุงููุณุงุนุฏ ุงูุฐูู! ููู ูููููู ูุณุงุนุฏุชู ุงููููุ',
    trigger: 'main-options',
  },
  {
    id: 'main-options',
    options: [
      { value: 'disorders', label: 'ูุนูููุงุช ุนู ุงุถุทุฑุงุจุงุช ุงูุชุฎุงุทุจ', trigger: 'disorders-menu' },
      { value: 'autism', label: 'ูุนูููุงุช ุนู ุทูู ุงูุชูุญุฏ', trigger: 'autism-intro' },
      { value: 'speech', label: 'ูุฏู ูุดููุฉ ุญุงููุฉ ูู ุงููุทู', trigger: 'speech-help' },
      { value: 'sound', label: 'ูุฏู ูุดููุฉ ุญุงููุฉ ูู ุงูุณูุน', trigger: 'sound-help' },
      { value: 'other', label: 'ูุฏู ุงุณุชูุณุงุฑ ุขุฎุฑ', trigger: 'free-input' },
    ],
  },
  // --- Free Input Branch ---
  {
    id: 'free-input',
    message: 'ุงูุชุจ ุงุณุชูุณุงุฑู ููุง ูุณุฃุญุงูู ุงููุณุงุนุฏุฉ.',
    trigger: 'user-input',
  },
  {
    id: 'user-input',
    user: true,
    trigger: 'end-message-other-query',
  },
  {
    id: 'end-message-other-query',
    message: 'ุดูุฑุงู ููุ ุชู ุชุณุฌูู ุงุณุชูุณุงุฑู ูุณูููู ุงูุฏูุชูุฑ ุจุงูุฑุฏ ุนููู ูู ุฃูุฑุจ ููุช ูููู.',
    trigger: 'end-or-menu',
  },
  
  // --- Speech Disorders Info Branch ---
  {
    id: 'disorders-menu',
    message: 'ุนู ุฃู ูู ุงุถุทุฑุงุจุงุช ุงูุชุฎุงุทุจ ุงูุชุงููุฉ ุชูุฏ ุฃู ุชุนุฑู ุงููุฒูุฏุ',
    trigger: 'disorders-options',
  },
  {
    id: 'disorders-options',
    options: [
      { value: 'language-delay', label: 'ุชุฃุฎุฑ ููู ุงููุบุฉ', trigger: 'language-delay-info' },
      { value: 'articulation', label: 'ุงุถุทุฑุงุจุงุช ุงููุทู (ุฅุจุฏุงู ุงูุญุฑูู)', trigger: 'articulation-info' },
      { value: 'stuttering', label: 'ุงูุชุฃุชุฃุฉ (ุงูุชูุชูุฉ)', trigger: 'stuttering-info' },
      { value: 'main-menu', label: 'ุงูุนูุฏุฉ ูููุงุฆูุฉ ุงูุฑุฆูุณูุฉ', trigger: 'main-options' },
    ]
  },
  {
    id: 'language-delay-info',
    message: 'ุชุฃุฎุฑ ููู ุงููุบุฉ ูุนูู ุฃู ููุงุฑุงุช ุงูุทูู ุงููุบููุฉ ุชุชุทูุฑ ุฃุจุทุฃ ูู ุฃูุฑุงูู. ูู ุนูุงูุงุชู:\n- ุนูุฑ ุณูุฉ ููุตู: ูุง ูููู ูููุงุช ุจุณูุทุฉ ูุซู "ูุงูุง" ุฃู "ุจุงุจุง".\n- ุนูุฑ ุณูุชูู: ูุง ูููู ุญุตููุชู 20-50 ูููุฉ.\n- ุนูุฑ 3 ุณููุงุช: ูุง ูููู ุฌููุฉ ูู ูููุชูู ุฃู ุซูุงุซ.\n- ุตุนูุจุฉ ูู ููู ุงูุชุนูููุงุช ุงูุจุณูุทุฉ.',
    trigger: 'disorders-after-info',
  },
  {
    id: 'articulation-info',
    message: 'ุงุถุทุฑุงุจุงุช ุงููุทู (ุงููุฏุบุงุช) ูู ุตุนูุจุฉ ูู ูุทู ุฃุตูุงุช ุงูุญุฑูู ุจุดูู ุตุญูุญ. ูู ุนูุงูุงุชูุง:\n- ุญุฐู ุจุนุถ ุงูุญุฑูู (ูููู "ุณุงุนุฉ" ุจุฏูุงู ูู "ุณุจุงุญุฉ").\n- ุฅุจุฏุงู ุญุฑู ุจุญุฑู ุขุฎุฑ (ูููู "ุชุชุงุจ" ุจุฏูุงู ูู "ูุชุงุจ").\n- ุชุดููู ุตูุช ุงูุญุฑู ุจุญูุซ ูููู ุบูุฑ ูุงุถุญ (ูุทู ุงูุณูู ุซุงุกู ูุซูุงู).',
    trigger: 'disorders-after-info',
  },
  {
    id: 'stuttering-info',
    message: 'ุงูุชุฃุชุฃุฉ ูู ุงุถุทุฑุงุจ ูู fluidez (ุทูุงูุฉ) ุงูููุงู. ูู ุนูุงูุงุชูุง:\n- ุชูุฑุงุฑ ุงูุฃุตูุงุช ุฃู ุงููููุงุช (ูุซุงู: "ุฃ-ุฃ-ุฃูุง ุฃุฑูุฏ").\n- ุฅุทุงูุฉ ุจุนุถ ุงูุฃุตูุงุช (ูุซุงู: "ููููููููููู").\n- ุชููู ูุงูู ูููุงุฌุฆ ุฃุซูุงุก ุงูููุงู.',
    trigger: 'disorders-after-info',
  },
  {
    id: 'disorders-after-info',
    message: 'ููุงุญุธุฉ ูุงูุฉ: ูุฐู ุงููุนูููุงุช ูู ุฅุฑุดุงุฏูุฉ ููุท ููุง ุชุบูู ุนู ุงูุชูููู ุงูุฏููู ูู ูุจู ุฃุฎุตุงุฆู ุงูุชุฎุงุทุจ.\n\nูู ุชูุฏ ูุนุฑูุฉ ุงููุฒูุฏ ุนู ุงุถุทุฑุงุจ ุขุฎุฑุ',
    trigger: 'disorders-after-info-options',
  },
  {
    id: 'disorders-after-info-options',
    options: [
      { value: 'more-disorders', label: 'ูุนูุ ุงุฎุชุฑ ุงุถุทุฑุงุจุงู ุขุฎุฑ', trigger: 'disorders-menu' },
      { value: 'main-menu', label: 'ุงูุนูุฏุฉ ูููุงุฆูุฉ ุงูุฑุฆูุณูุฉ', trigger: 'main-options' },
      { value: 'end', label: 'ูุงุ ุดูุฑุงู ูู', trigger: 'end-message-friendly' },
    ]
  },

  // --- Autism Branch ---
  {
    id: 'autism-intro',
    message: 'ุงุถุทุฑุงุจ ุทูู ุงูุชูุญุฏ ูู ุญุงูุฉ ุชุฑุชุจุท ุจููู ุงูุฏูุงุบ ูุชุคุซุฑ ุนูู ููููุฉ ุชูุงุตู ุงูุดุฎุต ูุชูุงุนูู ูุน ุงูุขุฎุฑูู. ูู ุชูุฏ ูุนุฑูุฉ ุงููุฒูุฏ ุนู ุงูุฃุนุฑุงุถุ',
    trigger: 'autism-options-1',
  },
  {
    id: 'autism-options-1',
    options: [
      { value: 'yes-symptoms', label: 'ูุนูุ ุฃุฎุจุฑูู ุนู ุงูุฃุนุฑุงุถ', trigger: 'autism-symptoms' },
      { value: 'no-thanks', label: 'ูุงุ ุดูุฑุงู', trigger: 'end-message-friendly' },
    ],
  },
  {
    id: 'autism-symptoms',
    message: 'ุชุฎุชูู ุงูุฃุนุฑุงุถ ูู ุดุฎุต ูุขุฎุฑุ ูููููุง ุชุดูู ุจุดูู ุนุงู ุตุนูุจุงุช ูู ุงูุชูุงุตู ุงูุงุฌุชูุงุนูุ ูุณููููุงุช ูุชูุฑุฑุฉุ ูุงูุชูุงูุงุช ูุญุฏูุฏุฉ. ูุซูุงูุ ูุฏ ูุฌุฏ ุงูุทูู ุตุนูุจุฉ ูู ุจุฏุก ูุญุงุฏุซุฉ ุฃู ููู ุงูุฅุดุงุฑุงุช ุงูุงุฌุชูุงุนูุฉ.',
    trigger: 'autism-options-2',
  },
  {
    id: 'autism-options-2',
    options: [
        { value: 'more-info', label: 'ูุงุฐุง ูููููู ุฃู ุฃูุนูุ', trigger: 'autism-advice' },
        { value: 'main-menu', label: 'ุงูุนูุฏุฉ ูููุงุฆูุฉ ุงูุฑุฆูุณูุฉ', trigger: 'main-options' },
    ]
  },
  {
      id: 'autism-advice',
      message: 'ุงูุชุดุฎูุต ูุงูุชุฏุฎู ุงููุจูุฑ ูููุงู ุฌุฏุงู. ูููุตุญ ุจุงูุชุญุฏุซ ูุน ุทุจูุจ ุฃุทูุงู ุฃู ุฃุฎุตุงุฆู ููุณู. ุงูุนูุงุฌ ุงูุณูููู ูุชุฏุฑูุจ ุงูููุงุฑุงุช ุงูุงุฌุชูุงุนูุฉ ูููู ุฃู ูุณุงุนุฏุง ุจุดูู ูุจูุฑ. ุชุฐูุฑุ ุงูุฏุนู ูุงูุชููู ูู ุงูุฃุณุฑุฉ ูู ุฃูู ุดูุก.',
      trigger: 'autism-end'
  },
  {
      id: 'autism-end',
      options: [
        { value: 'main-menu', label: 'ุงูุนูุฏุฉ ูููุงุฆูุฉ ุงูุฑุฆูุณูุฉ', trigger: 'main-options' },
        { value: 'end', label: 'ุฅููุงุก ุงููุญุงุฏุซุฉ', trigger: 'end-message-friendly' },
      ]
  },

  // --- Speech Problems Branch (Existing) ---
  {
    id: 'speech-help',
    message: 'ูู ุชูุงุฌู ุตุนูุจุฉ ูู ูุทู ุจุนุถ ุงูุญุฑูู ุฃู ุงูุฃุตูุงุชุ',
    trigger: 'speech-response',
  },
  {
    id: 'speech-response',
    options: [
      { value: 'difficulty', label: 'ูุนูุ ุนูุฏู ุตุนูุจุฉ', trigger: 'speech-difficulty' },
      { value: 'no-difficulty', label: 'ูุงุ ูุง ุฃูุงุฌู ุตุนูุจุฉ', trigger: 'main-options' },
    ],
  },
  {
    id: 'speech-difficulty',
    message: 'ุฅุฐุง ููุช ุชุฌุฏ ุตุนูุจุฉ ูู ูุทู ุจุนุถ ุงูุญุฑููุ ููุฏ ุชููู ูุฐู ูุดููุฉ ุชุญุชุงุฌ ุฅูู ุชูุฑูู. ุฅููู ุจุนุถ ุงููุตุงุฆุญ: \n1. ุญุงูู ุงูุชุญุฏุซ ุจุจุทุก ููุถูุญ. \n2. ุชูุฑู ุนูู ูุทู ุงูุญุฑูู ุชุฏุฑูุฌููุง. \n3. ุงุณุชุดุฑ ุฃุฎุตุงุฆู ูุทู ููุญุตูู ุนูู ูุณุงุนุฏุฉ ูุชุฎุตุตุฉ.',
    trigger: 'end-or-menu',
  },

  // --- Hearing Problems Branch (Existing) ---
  {
    id: 'sound-help',
    message: 'ูู ุชูุงุฌู ุตุนูุจุฉ ูู ุณูุงุน ุงูุฃุตูุงุชุ',
    trigger: 'sound-response',
  },
  {
    id: 'sound-response',
    options: [
      { value: 'yes-sound', label: 'ูุนูุ ุฃูุงุฌู ุตุนูุจุฉ', trigger: 'sound-details' },
      { value: 'no-sound', label: 'ูุงุ ูุง ุฃูุงุฌู ุตุนูุจุฉ', trigger: 'main-options' },
    ],
  },
  {
      id: 'sound-details',
      message: 'ุถุนู ุงูุณูุน ูู ุฃุณุจุงุจ ุนุฏูุฏุฉ. ูู ุงูููู ุฒูุงุฑุฉ ุทุจูุจ ุฃูู ูุฃุฐู ูุญูุฌุฑุฉ ูุนูู ูุญุต ุฏููู ูุชุญุฏูุฏ ุงูุณุจุจ ูุงูุนูุงุฌ ุงูููุงุณุจ.',
      trigger: 'end-or-menu'
  },
  
  // --- Endings and Loops ---
  {
    id: 'end-or-menu',
    message: 'ูู ูููููู ูุณุงุนุฏุชู ุจุดูุก ุขุฎุฑุ',
    trigger: 'end-or-menu-options'
  },
  {
    id: 'end-or-menu-options',
    options: [
        { value: 'main-menu', label: 'ูุนูุ ุนุฏ ูููุงุฆูุฉ ุงูุฑุฆูุณูุฉ', trigger: 'main-options' },
        { value: 'end', label: 'ูุงุ ุดูุฑุงู ูู', trigger: 'end-message-friendly' },
    ]
  },
  {
    id: 'end-message',
    message: 'ุดูุฑุงู ูุงุณุชุฎุฏุงูู ุงููุณุงุนุฏ ุงูุฐูู. ุฅุฐุง ุงุญุชุฌุช ุฃู ูุณุงุนุฏุฉ ูู ุงููุณุชูุจูุ ููุง ุชุชุฑุฏุฏ ูู ุงูุชูุงุตู ูุนูุง!',
    end: true,
  },
  {
    id: 'end-message-friendly',
    message: 'ุนูู ุงูุฑุญุจ ูุงูุณุนุฉ! ุฃุชููู ูู ูููุงู ุณุนูุฏุงู ๐',
    end: true,
  }
];

const AIChat = () => (
  <ThemeProvider theme={theme}>
    <div className="ai-chat-container">
      <h3 className="ai-chat-header">ุงููุณุงุนุฏ ุงูุฐูู ๐ค</h3>
      <ChatBot
        steps={steps}
        botAvatar="https://cdn-icons-png.flaticon.com/512/4712/4712027.png"
        userAvatar="https://cdn-icons-png.flaticon.com/512/4712/4712034.png"
        placeholder="ุงูุชุจ ุฑุณุงูุชู..."
        headerTitle="ุงููุณุงุนุฏ ุงูุฐูู"
        floating={false}
        width="100%"
        // Overwriting styles directly for better control
        style={{
          borderRadius: "12px",
          boxShadow: "0 4px 20px rgba(0, 0, 0, 0.1)",
        }}
        contentStyle={{ padding: '0px' }}
        bubbleOptionStyle={{
            backgroundColor: '#fff',
            color: '#0d6efd',
            border: '1px solid #0d6efd',
        }}
      />
    </div>
  </ThemeProvider>
);

export default AIChat;
